# AGENTS.md - VibedQA

> ì½”ë”© ì—ì´ì „íŠ¸(Claude, Cursor, Copilot ë“±)ë¥¼ ìœ„í•œ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ ì¸ë±ìŠ¤

## Quick Reference

**ëª©ì **: URL í•˜ë‚˜ë¡œ ì›¹ì•±ì„ ììœ¨ íƒìƒ‰ + AI ë¶„ì„í•˜ëŠ” Visual QA ë´‡
**ìŠ¤íƒ**: Node.js + TypeScript + Playwright + Gemini Vision API + pixelmatch
**ì‹¤í–‰**: `npx vibedqa --url https://example.com`
**í•µì‹¬**: ìŠ¤í¬ë¦°ìƒ·ë§Œ ì°ëŠ” ë„êµ¬ ì•„ë‹˜. ì‹¤ì œ í´ë¦­/ì…ë ¥/ë„¤ë¹„ê²Œì´ì…˜í•˜ëŠ” ììœ¨ QA ë´‡.

---

## Architecture: 3-Phase Pipeline
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER INPUT                         â”‚
â”‚            npx vibedqa --url [URL]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 1: AUTONOMOUS CRAWLER (Playwright)             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â€¢ í˜ì´ì§€ ë¡œë“œ + ìš”ì†Œ ê°ì§€                              â”‚
â”‚  â€¢ í´ë¦­ ê°€ëŠ¥ ìš”ì†Œ ìë™ ìˆœíšŒ (button, a, select ë“±)      â”‚
â”‚  â€¢ í¼ í•„ë“œ ìë™ ì…ë ¥                                   â”‚
â”‚  â€¢ ë§í¬ ë”°ë¼ê°€ê¸° (BFS, depth ì œí•œ)                      â”‚
â”‚  â€¢ ë‹¤í¬/ë¼ì´íŠ¸, í•œ/ì˜, ëª¨ë°”ì¼/ë°ìŠ¤í¬íƒ‘ ì „í™˜ ìº¡ì³         â”‚
â”‚  â€¢ ì½˜ì†”/ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ìˆ˜ì§‘                              â”‚
â”‚  â€¢ ê° ìƒíƒœ ë³€í™”ë§ˆë‹¤ ìŠ¤í¬ë¦°ìƒ·                            â”‚
â”‚  Output: screenshots[], errors[], interactionLog[]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 2: AI ANALYSIS (Gemini Vision)                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â€¢ ìŠ¤í¬ë¦°ìƒ· â†’ Gemini Vision ë¶„ì„ (UI ê¹¨ì§, i18n ë“±)   â”‚
â”‚  â€¢ ìŠ¤í¬ë¦°ìƒ· diff â†’ pixelmatch (ë ˆì´ì•„ì›ƒ shift)         â”‚
â”‚  â€¢ ì½˜ì†” ì—ëŸ¬ â†’ AI ì›ì¸ ë¶„ì„ + fix ì œì•ˆ                 â”‚
â”‚  Output: issues[], diffs[], errorAnalysis[]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 3: REPORT GENERATION                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â€¢ ì´ìŠˆ ì‹¬ê°ë„ ë¶„ë¥˜ (Critical/Warning/Info)            â”‚
â”‚  â€¢ HTML ë¦¬í¬íŠ¸ ìƒì„± (ìŠ¤í¬ë¦°ìƒ· + ì¬í˜„ê²½ë¡œ + fix ì œì•ˆ)    â”‚
â”‚  â€¢ í„°ë¯¸ë„ ìš”ì•½ ì¶œë ¥                                    â”‚
â”‚  Output: report.html, terminal summary               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Structure Map

### Core Files (Root)
| File | Role |
|------|------|
| `src/index.ts` | ì—”íŠ¸ë¦¬í¬ì¸íŠ¸, ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ |
| `src/cli.ts` | CLI ì˜µì…˜ íŒŒì‹± (commander.js) |
| `src/config.ts` | ScanConfig íƒ€ì… + ê¸°ë³¸ê°’ |
| `src/types.ts` | ì „ì²´ TypeScript íƒ€ì… ì •ì˜ |

### Crawler (`src/crawler/`)
| File | Role |
|------|------|
| `index.ts` | í¬ë¡¤ëŸ¬ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° |
| `explorer.ts` | í˜ì´ì§€ íƒìƒ‰ + ë§í¬ ìˆ˜ì§‘ (BFS, depth ì œí•œ) |
| `interactor.ts` | ìš”ì†Œ í´ë¦­ + í¼ ì…ë ¥ + ìƒíƒœ ë³µê·€ |
| `screenshotter.ts` | ìŠ¤í¬ë¦°ìƒ· ì´¬ì˜ + íŒŒì¼ ê´€ë¦¬ |
| `stateDetector.ts` | DOM/URL/ëª¨ë‹¬ ìƒíƒœ ë³€í™” ê°ì§€ |
| `errorCollector.ts` | console.error, pageerror, 4xx/5xx ìˆ˜ì§‘ |
| `variantCapture.ts` | ë‹¤í¬/ë¼ì´íŠ¸, í•œ/ì˜, ë·°í¬íŠ¸ ì „í™˜ + ìº¡ì³ |

### Analyzer (`src/analyzer/`)
| File | Role |
|------|------|
| `index.ts` | ë¶„ì„ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° |
| `vision.ts` | Gemini Vision API í˜¸ì¶œ + ì‘ë‹µ íŒŒì‹± |
| `diff.ts` | pixelmatch ìŠ¤í¬ë¦°ìƒ· ë¹„êµ + diff ì´ë¯¸ì§€ ìƒì„± |
| `consoleAnalyzer.ts` | ì½˜ì†” ì—ëŸ¬ ë¶„ë¥˜ + AI fix ì œì•ˆ |
| `prompts.ts` | ëª¨ë“  AI í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (ë‹¨ì¼ë¶„ì„, ë¹„êµ, ì—ëŸ¬) |

### Reporter (`src/reporter/`)
| File | Role |
|------|------|
| `index.ts` | ë¦¬í¬íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° |
| `html.ts` | HTML ë¦¬í¬íŠ¸ ìƒì„± |
| `terminal.ts` | í„°ë¯¸ë„ ìš”ì•½ ì¶œë ¥ (chalk) |
| `template.html` | HTML ë¦¬í¬íŠ¸ í…œí”Œë¦¿ |

### Utils (`src/utils/`)
| File | Role |
|------|------|
| `logger.ts` | ì»¬ëŸ¬ í„°ë¯¸ë„ ë¡œê¹… |
| `fileManager.ts` | ìŠ¤í¬ë¦°ìƒ·/ë¦¬í¬íŠ¸ íŒŒì¼ ì €ì¥ ê²½ë¡œ ê´€ë¦¬ |

---

## Key Types (types.ts)
```typescript
// ì£¼ìš” íƒ€ì… ìš”ì•½. ìƒì„¸ëŠ” types.ts ì°¸ì¡°.

ScanConfig          // CLI ì˜µì…˜ â†’ ìŠ¤ìº” ì„¤ì •
InteractionLog      // í´ë¦­/ì…ë ¥ ë“± ê° ì•¡ì…˜ ê¸°ë¡
Screenshot          // ìŠ¤í¬ë¦°ìƒ· ë©”íƒ€ (url, viewport, theme, lang, state)
ConsoleError        // ì½˜ì†” ì—ëŸ¬ (type, message, url, triggerAction)
Issue               // AI ë¶„ì„ ê²°ê³¼ (severity, category, fixSuggestion)
Report              // ìµœì¢… ë¦¬í¬íŠ¸ (summary, issues, errors, screenshots)
```

---

## CLI Options
```bash
npx vibedqa --url [URL]           # ê¸°ë³¸ ì‹¤í–‰
  --lang ko,en                     # ì–¸ì–´
  --theme dark,light               # í…Œë§ˆ
  --viewport desktop,mobile        # ë·°í¬íŠ¸
  --depth 3                        # íƒìƒ‰ depth
  --output ./reports               # ì¶œë ¥ ê²½ë¡œ
  --ai-model gemini                # AI ëª¨ë¸
  --no-click                       # í´ë¦­ ë¹„í™œì„±í™”
  --no-input                       # í¼ ì…ë ¥ ë¹„í™œì„±í™”
  --no-navigate                    # ë„¤ë¹„ê²Œì´ì…˜ ë¹„í™œì„±í™”
  --max-clicks 50                  # í˜ì´ì§€ë‹¹ ìµœëŒ€ í´ë¦­
  --timeout 30000                  # íƒ€ì„ì•„ì›ƒ (ms)
  --verbose                        # ìƒì„¸ ë¡œê·¸
```

---

## Crawler: Interaction Rules

### í´ë¦­ ëŒ€ìƒ
```
button, a[href], input[type=submit], input[type=button],
select, [role=button], [onclick], [tabindex] + click handler
```

### í´ë¦­ ìˆœì„œ
1. ë³´ì´ëŠ” ìš”ì†Œë§Œ í•„í„° (`isVisible`)
2. ìœ„â†’ì•„ë˜, ì™¼â†’ì˜¤ ìˆœì„œ
3. í´ë¦­ â†’ ìƒíƒœ ëŒ€ê¸° â†’ ìŠ¤í¬ë¦°ìƒ·
4. ì›ë˜ ìƒíƒœ ë³µê·€ (ëª¨ë‹¬ ë‹«ê¸° / ë’¤ë¡œê°€ê¸°)
5. ë‹¤ìŒ ìš”ì†Œ

### í¼ ì…ë ¥ ê°’
| íƒ€ì… | í…ŒìŠ¤íŠ¸ ë°ì´í„° |
|------|--------------|
| text | "VibedQA Test Input" |
| email | "test@vibedqa.com" |
| password | "TestPass123!" |
| number | "42" |
| url | "https://example.com" |
| textarea | "This is a test input from VibedQA." |
| select | ì²« ë²ˆì§¸ non-disabled ì˜µì…˜ |

### ë„¤ë¹„ê²Œì´ì…˜ ê·œì¹™
- ê°™ì€ ë„ë©”ì¸ë§Œ
- ë°©ë¬¸ URL Set ê´€ë¦¬ (ì¤‘ë³µ ë°©ì§€)
- BFS, depth ì œí•œ (ê¸°ë³¸ 3)
- SPA: hashchange, popstate ê°ì§€

---

## Issue Severity

| ì‹¬ê°ë„ | ê¸°ì¤€ | ì˜ˆì‹œ |
|--------|------|------|
| ğŸ”´ Critical | ê¸°ëŠ¥ ë¶ˆê°€, í¬ë˜ì‹œ | 404, ë¹ˆ í™”ë©´, JS í¬ë˜ì‹œ |
| ğŸŸ¡ Warning | ì‹œê°ì  ë¬¸ì œ, UX ì €í•˜ | ë ˆì´ì•„ì›ƒ shift, contrast, í•˜ë“œì½”ë”© ë¬¸ìì—´ |
| ğŸ”µ Info | ê°œì„  ì œì•ˆ | ì‘ì€ í´ë¦­ íƒ€ê²Ÿ, ì ‘ê·¼ì„±, UX |

---

## Development Conventions

### Playwright
- locator ìš°ì„ : `getByRole` > `getByText` > `getByTestId` > CSS
- ëŒ€ê¸°: `waitForSelector` > `waitForLoadState` > `waitForTimeout` (ìµœí›„ìˆ˜ë‹¨)
- í´ë¦­ ì „ `isVisible()` ì²´í¬ í•„ìˆ˜
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” `page.goto()` ì „ì— ë“±ë¡
- `page.evaluate()` ì•ˆì—ì„œ ì™¸ë¶€ ë³€ìˆ˜ ì§ì ‘ ì°¸ì¡° ë¶ˆê°€ â†’ íŒŒë¼ë¯¸í„° ì „ë‹¬

### Gemini Vision API
- ì´ë¯¸ì§€ base64 ì¸ì½”ë”© ì „ì†¡
- JSON ì‘ë‹µ ìš”ì²­ ì‹œ í”„ë¡¬í”„íŠ¸ì— ëª…ì‹œ
- íŒŒì‹± ì‹œ ```json íœìŠ¤ ì œê±° í›„ JSON.parse
- rate limit: í˜¸ì¶œ ê°„ 1ì´ˆ ë”œë ˆì´, 3íšŒ retry

### Git
- ì»¤ë°‹ ì˜ì–´, ê°„ê²°
- `feat:` / `fix:` / `refactor:` / `docs:` / `chore:`

---

## Common Tasks

### ìƒˆ í¬ë¡¤ëŸ¬ ê¸°ëŠ¥ ì¶”ê°€
1. `crawler/` ë‚´ í•´ë‹¹ íŒŒì¼ ìˆ˜ì • ë˜ëŠ” ìƒˆ íŒŒì¼ ìƒì„±
2. `crawler/index.ts` ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ì— í†µí•©
3. `types.ts`ì— í•„ìš”í•œ íƒ€ì… ì¶”ê°€

### AI í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
1. `analyzer/prompts.ts` ìˆ˜ì •
2. JSON ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‹œ `types.ts`ë„ ì—…ë°ì´íŠ¸
3. `analyzer/vision.ts` íŒŒì‹± ë¡œì§ í™•ì¸

### ë¦¬í¬íŠ¸ ìˆ˜ì •
1. `reporter/template.html` â€” UI/ë ˆì´ì•„ì›ƒ
2. `reporter/html.ts` â€” ë°ì´í„° ë°”ì¸ë”©
3. `reporter/terminal.ts` â€” í„°ë¯¸ë„ ì¶œë ¥ í˜•ì‹

### CLI ì˜µì…˜ ì¶”ê°€
1. `cli.ts`ì— ì˜µì…˜ ì¶”ê°€
2. `config.ts`ì— ê¸°ë³¸ê°’ + íƒ€ì… ì¶”ê°€
3. `types.ts` ScanConfig ì—…ë°ì´íŠ¸

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| Playwright ì„¤ì¹˜ ì•ˆë¨ | `npx playwright install chromium` |
| ìŠ¤í¬ë¦°ìƒ· ë¹ˆ í™”ë©´ | `waitForLoadState` ë˜ëŠ” `waitForSelector` ì¶”ê°€ |
| Gemini API ì—ëŸ¬ | API í‚¤ í™•ì¸, rate limit ì²´í¬ |
| í´ë¦­ì´ ì•ˆ ë¨¹í˜ | `isVisible` ì²´í¬, `scrollIntoViewIfNeeded` ì¶”ê°€ |
| SPA í˜ì´ì§€ ì „í™˜ ê°ì§€ ì•ˆë¨ | `waitForURL` ë˜ëŠ” `waitForFunction` ì‚¬ìš© |

---

## References

| ë¬¸ì„œ | ë‚´ìš© |
|------|------|
| CLAUDE.md | Claude Code ì „ìš© ì»¨í…ìŠ¤íŠ¸ |
| VIBEDQA_PLAN.md | ì „ì²´ ê¸°íš ë¬¸ì„œ (ìƒì„¸ ìŠ¤í™, ë°ì´í„° ëª¨ë¸, ë¡œë“œë§µ) |
